<% layout('layouts/boilerplate.ejs') %>



    <div class="row">
        <h1 class="text-center">Edit User</h1>
        <div class="col-6 offset-3">
            <form action="/Users/<%= user.id %>?_method=PUT" method="POST" class="needs-validation" enctype="multipart/form-data" novalidate>
                <div class="mb-3">
                    <label for="name" class="form-label"><strong>Name</strong></label>
                    <input class="form-control" type="text" id="name" name="user[name]" placeholder="ABC XYZ" value="<%= user.name %>" required/>
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Name is required!
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="rollno" class="form-label"><strong>RollNo</strong></label>
                    <input class="form-control" type="text" id="rollno" name="user[rollno]" placeholder="2010xxxx" value="<%= user.rollno %>" required />
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        RollNo is required!
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="branch" class="form-label"><strong>Branch</strong></label>
                    <input class="form-control" type="text" id="branch" name="user[branch]" value="<%= user.branch %>" required />
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Branch is required!
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="semester" class="form-label"><strong>Current Semester</strong></label>
                    <input class="form-control" type="text" id="semester" name="user[semester]" value="<%= user.semester %>" required />
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Current semester is required!
                    </div>
                </div>
                <div class="mb-3">
                    <label for="clubs"><strong>Proficiency</strong></label>
                    <select class="form-select" id="clubs" aria-label="clubs" name="user[club]" required>
                    <% for(let club of clubs){ %>
                        <option value="<%=club%>" <%= user.club === club ? 'selected': '' %> ><%=club%></option>
                        <% } %>
                  </select>
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Please select a club.
                    </div>
                </div>
                <div class="row">

                    <div class="col">
                        <label class="form-label" for="state" class="form-label"><strong>State</strong></label>
                        <input class="form-control" type="text" id="state" name="user[state]" value="<%= user.state %>" required/>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            Your state is required!
                        </div>
                    </div>
                    <div class="col">
                        <label for="cgpa"><strong>CGPA</strong></label>
                        <div class="input-group mb-3">
                            <input type="text" id="cgpa" class="form-control" placeholder="8.00" aria-label="cgpa" name="user[cgpa]" value="<%= user.cgpa %>" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                            <div class="invalid-feedback">
                                your cgpa is required!
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label" for="description" class="form-label"><strong>About User</strong></label>
                    <textarea class="form-control" type="text" id="description" name="user[description]" required><%= user.description %></textarea>
                    <div class="valid-feedback">
                        Looks good!
                    </div>
                    <div class="invalid-feedback">
                        Fill something about yourself!
                    </div>
                </div>
                <div class="mb-3">
                    <label for="image" class="form-label"><strong>Add Images</strong></label>
                    <div class="form-file custom-file">
                        <label for="image" class="form-label custom-file-label"></label>
                        <input class="form-control" type="file" id="image" name="image" multiple>
                      </div>
                </div>
                
                <h6>Delete Images</h6>
                <div class="row row-cols-1 row-cols-md-4 g-4 mb-3">
                  <% user.image.forEach((img, i) => { %>
                  <div class="col">
                    <div class="card">
                      <img class="card-img" src="<%= img.url %>" alt="">
                      <div class="card-img-overlay text-end pt-1 pe-2">
                        <label class="visually-hidden" for="image-<%= i %>">Delete Image</label>
                        <input class="form-check-input" type="checkbox" name="deleteImages[]" value="<%= img.filename %>"  id="image-<%= i %>">
                      </div> 
                    </div> 
                </div> 
                      <% }) %>
                    </div> 
                <div class="mb-3">
                    <button class="btn btn-success">Update user</button>
                </div>
            </form>
            <a class="btn btn-warning mb-3" href="/Users/<%= user.id %> ">Back to User</a>
        </div>
    </div>